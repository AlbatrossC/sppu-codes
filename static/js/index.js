console.log(`
    â €â €â €â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â£¿â£¿â£¿â¡†â €â €â €â¢€â£´â£¶â£¶â£¶â£¶â£„â €â£€â£´â£¶â£¶â£¶â£¶â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â €â €â €â €â €â¢ â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¦â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â¢ˆâ£¿â£¿â €â €â €â €â €â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â €â €â €â €â €â ¸â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â €â €â €â €â €â €â ¹â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â Ÿâ â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â €â €â €â €â €â €â €â ˆâ »â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â ‹â €â €â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â¢€â£€â£¸â£¿â£¿â£€â£€â¡€â €â €â €â €â €â €â ˆâ »â¢¿â¢¿â£¿â£¿â£¿â Ÿâ â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â ¸â ¿â ¿â ¿â ¿â ¿â ¿â ‡â €â €â €â €â €â €â €â €â €â ˆâ ™â ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €
    â €â €â €â €â¢¾â£¿â£¿â£¿â£¿â£¿â£¿â †â  â£¿â¡¿â£¿â£¿â£¿â¢¿â£¿â£¦â£´â£¿â¡¿â ¿â¢¿â£¿â£·â£„â €â¢¾â£¿â£¿â£¿â£¿â¡¿â£¿â †â¢¸â£¿â£¿â£¿â£¿â£¿â¡†â €â €â €â €
    â €â €â €â €â €â €â ˆâ¢¿â£¿â£§â €â €â €â €â£ â£¿â¡¿â â €â£°â£¿â¡¿â â €â €â €â ˆâ »â£¿â£§â¡€â €â ˜â£¿â¡Ÿâ €â €â €â €â €â¢¸â£¿â£¿â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â¢»â£¿â£§â¡€â €â¢°â£¿â¡¿â â €â €â£¿â£¿â â €â €â €â €â €â €â¢»â£¿â£‡â €â €â£¿â¡‡â €â €â €â €â €â ¸â£¿â£¿â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â ¹â£¿â£·â£´â£¿â¡Ÿâ €â €â €â¢°â£¿â¡Ÿâ €â €â €â €â €â €â €â¢¸â£¿â£¿â €â €â£¿â¡‡â €â €â €â €â €â¢¸â£¿â£¿â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â ™â£¿â£¿â¡â €â €â €â €â ˜â£¿â£§â €â €â €â €â €â €â €â¢¸â£¿â£¿â €â €â£¿â¡‡â €â €â €â €â €â¢¸â£¿â£¿â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â£¿â£¿â¡€â €â €â €â €â €â£¿â£¿â¡„â €â €â €â €â €â €â£¿â£¿â ‡â €â €â£¿â£§â €â €â €â €â €â¢¸â£¿â£¿â €â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â¢€â£€â£€â£¿â£¿â£‡â£€â¡€ â €â ˜â¢¿â£¿â£¦â£€â €â¢€â£ â£¾â£¿â â €â € â¢¿â£¿â£¦â¡€â €â €â£€â£¼â£¿â €â €â €â €â €â €
    â €â €â €â €â €â €â €â €â »â ¿â ¿â ¿â ¿â ¿â ¿â ¿â €â €â €â €â ™â ¿â¢¿â£¿â£¿â ¿â ›â â €â €â €â €â €â ™â ¿â¢¿â£¿â£¿â¡¿â Ÿâ €â €â €â €â €
    
    
            Hey, you! ðŸ‘€ Guess what?
                Sppu Codes is open-source
                    and totally free to explore! ðŸŽ‰
                        Dive in: https://github.com/AlbatrossC/sppu-codes
            â €
    `);
// ... [Keep the initial console.log ASCII art exactly as it is] ...

(function () {
    /* =====================================================
       GOOGLE TAG (UNCHANGED)
    ===================================================== */
    function loadGTM() {
        const script = document.createElement('script');
        script.src = 'https://www.googletagmanager.com/gtag/js?id=G-1R5FFVKTF8';
        script.async = true;
        script.onload = function () {
            window.dataLayer = window.dataLayer || [];
            function gtag() { window.dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-1R5FFVKTF8');
        };
        document.head.appendChild(script);
    }

    if (document.readyState === 'complete') {
        loadGTM();
    } else {
        window.addEventListener('load', loadGTM);
    }
})();

document.addEventListener('DOMContentLoaded', function () {
    /* =====================================================
       ELEMENTS
    ===================================================== */
    const searchInput = document.getElementById('subject-search');
    const mobileSearchToggle = document.querySelector('.mobile-search-toggle');
    const searchContainer = document.querySelector('.search-container');
    const header = document.querySelector('header');

    const searchDropdown = document.createElement('div');
    searchDropdown.className = 'search-dropdown';
    document.body.appendChild(searchDropdown);

    /* =====================================================
       STATE
    ===================================================== */
    let isLoaded = false;
    const MAX_RESULTS = 10;

    const searchData = {
        questionPapers: [],
        codes: []
    };

    /* =====================================================
       UTILS â€“ STRING NORMALIZATION
    ===================================================== */
    function normalize(str) {
        if (!str) return "";
        return str
            .toLowerCase()
            .replace(/[^a-z0-9\s]/g, '')
            .replace(/\s+/g, ' ')
            .trim();
    }

    /* =====================================================
       FUZZY SCORE
    ===================================================== */
    function fuzzyScore(query, target) {
        if (!query || !target) return Infinity;
        query = normalize(query);
        target = normalize(target);

        if (target.startsWith(query)) return 0;
        if (target.includes(query)) return 1;

        const qTokens = query.split(' ');
        const tTokens = target.split(' ');
        let hits = 0;
        qTokens.forEach(qt => {
            if (tTokens.some(tt => tt.startsWith(qt))) hits++;
        });

        if (hits > 0) return 2 - hits * 0.1;
        return levenshtein(query, target);
    }

    function levenshtein(a, b) {
        if (a.length === 0) return b.length;
        if (b.length === 0) return a.length;
        const matrix = [];
        for (let i = 0; i <= b.length; i++) matrix[i] = [i];
        for (let j = 0; j <= a.length; j++) matrix[0][j] = j;
        for (let i = 1; i <= b.length; i++) {
            for (let j = 1; j <= a.length; j++) {
                if (b[i - 1] === a[j - 1]) matrix[i][j] = matrix[i - 1][j - 1];
                else matrix[i][j] = Math.min(matrix[i - 1][j - 1] + 1, matrix[i][j - 1] + 1, matrix[i - 1][j] + 1);
            }
        }
        return matrix[b.length][a.length];
    }

    /* =====================================================
       LOAD SEARCH DATA (FIXED KEYS)
    ===================================================== */
    async function loadSearchData() {
        if (isLoaded) return;
        try {
            // Question Papers
            const qpRes = await fetch('/api/question-papers/search');
            const qpData = await qpRes.json();
            searchData.questionPapers = qpData.map(item => ({
                type: 'QUESTION_PAPER',
                label: 'ðŸ“„ QP',
                subjectName: item.subject_name,
                link: item.link, // Matches API "link"
                branch: item.branch // Matches API "branch"
            }));

            // Codes (Subjects)
            const codeRes = await fetch('/api/subjects/search');
            const codeData = await codeRes.json();
            searchData.codes = codeData.map(s => ({
                type: 'CODE',
                label: 'ðŸ’» Code',
                subjectName: s.subject_name,
                subjectCode: s.subject_code,
                link: s.url || `/${s.subject_code}` // Use URL or generate from code
            }));

            isLoaded = true;
        } catch (err) {
            console.error('Search data load failed:', err);
        }
    }

    /* =====================================================
       SEARCH TOGGLE
    ===================================================== */
    if (mobileSearchToggle) {
        mobileSearchToggle.addEventListener('click', async (e) => {
            e.stopPropagation();
            searchContainer.classList.toggle('active');
            if (searchContainer.classList.contains('active')) {
                await loadSearchData();
                setTimeout(() => searchInput.focus(), 100);
            } else {
                searchDropdown.style.display = 'none';
            }
        });
    }

    /* =====================================================
       FILTER & SORT
    ===================================================== */
    function filterAndSort(query) {
        const resultsQP = [];
        const resultsCode = [];

        searchData.questionPapers.forEach(item => {
            const score = fuzzyScore(query, item.subjectName);
            if (score <= 3) resultsQP.push({ ...item, score });
        });

        searchData.codes.forEach(item => {
            const scoreName = fuzzyScore(query, item.subjectName);
            const scoreCode = fuzzyScore(query, item.subjectCode || "");
            const score = Math.min(scoreName, scoreCode);
            if (score <= 3) resultsCode.push({ ...item, score });
        });

        resultsQP.sort((a, b) => a.score - b.score);
        resultsCode.sort((a, b) => a.score - b.score);
        return { resultsQP, resultsCode };
    }

    /* =====================================================
       RENDER (FIXED DISPLAY LOGIC)
    ===================================================== */
    function renderResults(qp, codes) {
        searchDropdown.innerHTML = '';

        function renderSection(title, items, typeClass) {
            if (!items.length) return;

            const section = document.createElement('div');
            section.className = 'search-section';
            const header = document.createElement('div');
            header.className = 'search-section-header';
            header.textContent = title;
            section.appendChild(header);

            const list = document.createElement('div');
            list.className = 'search-section-list';

            items.slice(0, MAX_RESULTS).forEach(item => {
                const row = document.createElement('div');
                row.className = `search-result-row ${typeClass}`;

                let badge = '';
                if (typeClass === 'code-row' && item.subjectCode) {
                    badge = `<span class="result-shortcode">${item.subjectCode.toUpperCase()}</span>`;
                } else if (typeClass === 'qp-row' && item.branch) {
                    badge = `<span class="result-branch" style="font-size: 0.8em; color: #888; display: block;">${item.branch}</span>`;
                }

                row.innerHTML = `
                    <div style="display: flex; flex-direction: column; width: 100%;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span class="result-name">${item.subjectName}</span>
                            <span class="result-type-label" style="font-size: 0.7em; opacity: 0.6;">${item.label}</span>
                        </div>
                        ${badge}
                    </div>
                `;

                row.onclick = () => {
                    if (item.link) {
                        window.location.href = item.link;
                    }
                };
                list.appendChild(row);
            });

            section.appendChild(list);
            searchDropdown.appendChild(section);
        }

        renderSection('Question Papers', qp, 'qp-row');
        renderSection('Codes', codes, 'code-row');

        if (!qp.length && !codes.length) {
            searchDropdown.innerHTML = `<div class="search-no-results">No results found for "${searchInput.value}"</div>`;
        }
    }

    /* =====================================================
       POSITIONING & EVENTS
    ===================================================== */
    function positionDropdown() {
        const rect = searchInput.getBoundingClientRect();
        searchDropdown.style.top = `${rect.bottom + window.scrollY}px`;
        searchDropdown.style.left = `${rect.left + window.scrollX}px`;
        searchDropdown.style.width = `${rect.width}px`;
        searchDropdown.style.display = 'block';
    }

    searchInput.addEventListener('input', async () => {
        const query = searchInput.value.trim();
        if (!query) {
            searchDropdown.style.display = 'none';
            return;
        }
        await loadSearchData();
        const { resultsQP, resultsCode } = filterAndSort(query);
        renderResults(resultsQP, resultsCode);
        positionDropdown();
    });

    document.addEventListener('click', (e) => {
        if (!searchDropdown.contains(e.target) && e.target !== searchInput) {
            searchDropdown.style.display = 'none';
        }
    });

    window.addEventListener('scroll', () => {
        if (window.scrollY > 50) header.classList.add('scrolled');
        else header.classList.remove('scrolled');
        if (searchDropdown.style.display === 'block') positionDropdown();
    });
});